!function(){var e={3709:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),a=new I(n||[]);return i._invoke=function(e,t,r){var n=h;return function(o,i){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return V()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var l=x(a,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var u=s(e,t,r);if("normal"===u.type){if(n=r.done?p:d,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,a),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",v={};function g(){}function S(){}function m(){}var y={};y[i]=function(){return this};var k=Object.getPrototypeOf,C=k&&k(k(O([])));C&&C!==r&&n.call(C,i)&&(y=C);var w=m.prototype=g.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,l){var u=s(e[o],e,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,l)}),(function(e){r("throw",e,a,l)})):t.resolve(h).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,l)}))}l(u.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=s(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function O(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:V}}function V(){return{value:t,done:!0}}return S.prototype=w.constructor=m,m.constructor=S,S.displayName=u(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(E.prototype),E.prototype[a]=function(){return this},e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(w),u(w,l,"Generator"),w[i]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return l.type="throw",l.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},3949:function(e,t,r){e.exports=r(3709)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t,r,n,o,i,a){try{var l=e[i](a),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,o)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function l(t){e(a,o,i,l,u,"next",t)}function u(t){e(a,o,i,l,u,"throw",t)}l(void 0)}))}}var n=r(3949),o=r.n(n);function i(e){return!e||!e.trim()}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=function(){function e(){a(this,e)}var r,n;return u(e,null,[{key:"Sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"WaitForCondition",value:(n=t(o().mark((function t(r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(new Date).getTime();case 2:return t.next=4,r();case 4:if(t.t0=!t.sent,!t.t0){t.next=7;break}t.t0=i+n>(new Date).getTime();case 7:if(!t.t0){t.next=12;break}return t.next=10,e.Sleep(100);case 10:t.next=2;break;case 12:return t.next=15,r();case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)})},{key:"WaitForSyncCondition",value:(r=t(o().mark((function t(r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(new Date).getTime();case 2:if(!(i+n>(new Date).getTime())){t.next=9;break}if(!r()){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,e.Sleep(100);case 7:t.next=2;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})},{key:"IsValidDataField",value:function(e){return null!=e&&e.length>0&&"null"!==e}},{key:"IsOnPage",value:function(t,r){if(e.IsValidDataField(t)){var n,o=t.toLowerCase().replace(/\s+/g,"").split(","),i=r.toLowerCase(),a=!1,l=c(o);try{for(l.s();!(n=l.n()).done;){var u=n.value;if(i.indexOf(u)>=0){a=!0;break}}}catch(e){l.e(e)}finally{l.f()}return a}return!1}}]),e}();function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f,p=function e(){a(this,e),d(this,"name",void 0),d(this,"supported",void 0)};!function(e){e.autoShowControlForFeature="msEdgeShoppingAutoShowControlForFeature",e.bannerShowCashback="msEdgeShoppingBannerRebates",e.bannerShowCoupons="msEdgeShoppingBannerCoupons",e.bannerShowPriceComparison="msEdgeShoppingBannerPriceCompare",e.bannerShowPriceHistory="msEdgeShoppingBannerPriceHistory",e.cashbackNotification="msShoppingExp11",e.dealsBranding="msShoppingExp18",e.expressCheckout="msEdgeShoppingExpressCheckout",e.expressCheckoutFillDetails="msEdgeShoppingExpressCheckoutFillDetails",e.personalizedCashBack="msShoppingExp10",e.poleReviewsIfBestPrice="msShoppingExp7",e.poleReviewsIfNoDrop="msShoppingExp8",e.promotionsCashback="msShoppingExp15",e.rewardFlyout="msEdgeShoppingRewards",e.rewardNotification="msShoppingExp16",e.removeRebatesProcessingState="msShoppingExp5",e.showAmazonOtherSellers="msShoppingExp6",e.showMoreSellers="msShoppingExp3",e.showNudgeTips="msShoppingExp0",e.showNudgeTipsOverlay="msShoppingExp17",e.showPriceComparisonNotification="msShoppingExp14",e.showProductHistory="msWebAssistQuery",e.showRecommendations="msShoppingExp19",e.serverSideRenderingEnabled="msEdgeServerSideShopping",e.signinRebates="msEdgeShoppingRebatesSignUp",e.signinRewards="msEdgeShoppingRewardsSignUp",e.animationAutoApply="msShoppingExp12",e.showTrendingProducts="msShoppingExp1",e.expandOnHover="msShoppingExp9"}(f||(f={}));var v=function(){function e(){a(this,e),d(this,"experiments",void 0),d(this,"experimentsSet",void 0),this.experiments=[],this.experimentsSet=new Set}return u(e,[{key:"Create",value:function(e){var t=this,r=[];if(e&&e.length>0){var n=Object.values(f);e.forEach((function(e){var o=new p;o.name=e.name,o.supported=!1,n.includes(e.name)&&(o.supported=!0,t.experimentsSet.add(e.name)),r.push(o)}))}this.experiments=r}},{key:"CreateFromJsonStr",value:function(e){try{if(e){var t=JSON.parse(e);this.Create(t)}}catch(e){}}},{key:"isExperimentActive",value:function(e){return this.experimentsSet.has(e)}}]),e}(),g=function e(){a(this,e),d(this,"retailerData",void 0),d(this,"impressionId",void 0)},S=function(){function e(){a(this,e)}return u(e,[{key:"raiseMessageFromHost",value:function(e){var t=e.shift();if(t&&"CheckoutPageValidation"===t)try{"interactive"===document.readyState||"complete"===document.readyState?window.IsAutoApplyValid(e,!0):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){window.CheckAndIsAutoApplyValid(e,!0)}))}catch(e){}}},{key:"postMessageToHost",value:function(e,t){try{checkoutPageValidatorNativeHandler&&checkoutPageValidatorNativeHandler.sendMessageToHost(e,t)}catch(e){}}},{key:"initialize",value:function(e){e.splice(0,2);try{"interactive"===document.readyState||"complete"===document.readyState?window.IsAutoApplyValid(e,!1):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){window.CheckAndIsAutoApplyValid(e,!1)}))}catch(e){return!1}return!0}}]),e}(),m=function(){function e(){a(this,e),d(this,"ProductAddedNotification",void 0),d(this,"Url",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.ProductAddedNotification=t.ProductAddedNotification,r.Url=t.Url,r}}]),e}(),y=function(){function e(){a(this,e),d(this,"OtherSellersNotificationData",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.OtherSellersNotificationData=t.OtherSellersNotificationData,r}}]),e}(),k=function(){function e(){a(this,e),d(this,"otherSellersOverlayLinkSelector",void 0),d(this,"otherSellerOfferElementSelector",void 0),d(this,"otherSellerHeadingSelector",void 0),d(this,"otherSellerPriceSelector",void 0),d(this,"otherSellerNameSelector",void 0),d(this,"productImageSelector",void 0),d(this,"otherSellerRatingSelector",void 0),d(this,"otherSellerDeliverySelector",void 0),d(this,"otherSellerAddButtonSelector",void 0),d(this,"otherSellerAddedConfirmationSelector",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.otherSellersOverlayLinkSelector=t.otherSellersOverlayLinkSelector,r.otherSellerOfferElementSelector=t.otherSellerOfferElementSelector,r.otherSellerHeadingSelector=t.otherSellerHeadingSelector,r.otherSellerPriceSelector=t.otherSellerPriceSelector,r.otherSellerNameSelector=t.otherSellerNameSelector,r.productImageSelector=t.productImageSelector,r.otherSellerRatingSelector=t.otherSellerRatingSelector,r.otherSellerDeliverySelector=t.otherSellerDeliverySelector,r.otherSellerAddButtonSelector=t.otherSellerAddButtonSelector,r.otherSellerAddedConfirmationSelector=t.otherSellerAddedConfirmationSelector,r}}]),e}(),C=function(){function e(){a(this,e),d(this,"inputBoxSelector",void 0),d(this,"removeCouponButtonSelector",void 0),d(this,"orderTotalDataElementSelector",void 0),d(this,"disabled",void 0),d(this,"checkoutPageUrl",void 0),d(this,"layoutClickSelector",void 0),d(this,"clickBeforeStartSelector",void 0),d(this,"finalCheckoutButtonSelector",void 0),d(this,"edgeEnabled",void 0),d(this,"orderSubTotalElementSelector",void 0),d(this,"couponAcceptedMessageElementSelector",void 0),d(this,"closeModal",void 0),d(this,"appliedCouponSelector",void 0),d(this,"errorMessageSelector",void 0),d(this,"enabledTips",void 0),d(this,"otherSellersSelectors",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.inputBoxSelector=t.inputBoxSelector,r.removeCouponButtonSelector=t.removeCouponButtonSelector,r.orderTotalDataElementSelector=t.orderTotalDataElementSelector,r.checkoutPageUrl=t.checkoutPageUrl,r.clickBeforeStartSelector=t.clickBeforeStartSelector,r.layoutClickSelector=t.layoutClickSelector,r.finalCheckoutButtonSelector=t.finalCheckoutButtonSelector,r.disabled=t.disabled,r.edgeEnabled=t.edgeEnabled,r.orderSubTotalElementSelector=t.orderSubTotalElementSelector,r.couponAcceptedMessageElementSelector=t.couponAcceptedMessageElementSelector,r.closeModal=t.closeModal,r.appliedCouponSelector=t.appliedCouponSelector,r.errorMessageSelector=t.errorMessageSelector,r.enabledTips=t.enabledTips,t.otherSellersSelectors&&(r.otherSellersSelectors=k.Create(t.otherSellersSelectors)),r}}]),e}();function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var E=function(){function e(){a(this,e),d(this,"domainName",void 0),d(this,"allCheckoutPages",void 0),d(this,"allFinalCheckoutPages",void 0),d(this,"checkoutPageKey",void 0),d(this,"finalCheckoutPageKey",void 0),d(this,"exclusiveMarket",void 0)}return u(e,[{key:"updateCurrentCheckoutPage",value:function(e){var t=this.findCurrentPage(e,this.allCheckoutPages);return-1!==t?(this.checkoutPageKey=t,!0):(this.checkoutPageKey=null,!1)}},{key:"getCurrentCheckoutPage",value:function(){if(null!=this.checkoutPageKey)return this.allCheckoutPages[this.checkoutPageKey]}},{key:"updateCurrentFinalCheckoutPage",value:function(e){var t=this.findCurrentPage(e,this.allFinalCheckoutPages);return-1!==t?(this.finalCheckoutPageKey=t,!0):(this.finalCheckoutPageKey=null,!1)}},{key:"getCurrentFinalCheckoutPage",value:function(){if(null!=this.finalCheckoutPageKey)return this.allFinalCheckoutPages[this.finalCheckoutPageKey]}},{key:"createCheckoutPageList",value:function(e){if(this.allCheckoutPages=[],e.allCheckoutPages&&e.allCheckoutPages.length>0){var t,r=w(e.allCheckoutPages);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.allCheckoutPages.push(C.Create(n))}}catch(e){r.e(e)}finally{r.f()}}}},{key:"createFinalCheckoutPageList",value:function(e){if(this.allFinalCheckoutPages=[],e.allFinalCheckoutPages&&e.allFinalCheckoutPages.length>0){var t,r=w(e.allFinalCheckoutPages);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.allFinalCheckoutPages.push(C.Create(n))}}catch(e){r.e(e)}finally{r.f()}}}},{key:"findCurrentPage",value:function(e,t){for(var r=0;r<t.length;r++){if(h.IsOnPage(t[r].checkoutPageUrl,e))return t[r].disabled?-1:r}return-1}}],[{key:"Create",value:function(t){var r=new e;return r.domainName=t.domainName,r.exclusiveMarket=t.exclusiveMarket,r.createCheckoutPageList(t),r.createFinalCheckoutPageList(t),r}}]),e}(),x=function e(t,r,n,o,i){a(this,e),d(this,"Name",void 0),d(this,"Type",void 0),d(this,"Value",void 0),d(this,"IsMandatory",void 0),d(this,"Format",void 0),this.Name=t,this.Type=r,this.Value=n,this.IsMandatory=o,this.Format=i};function P(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I=function e(t,r,n){if(a(this,e),d(this,"PageUrl",void 0),d(this,"Type",void 0),d(this,"CheckoutElements",void 0),this.PageUrl=t,this.Type=r,this.CheckoutElements=new Map,n){var o,i=P(n);try{for(i.s();!(o=i.n()).done;){var l=o.value;if(l){var u=l.Name;u&&this.CheckoutElements.set(u,new x(u,l.Type,l.Value,l.IsMandatory,l.Format))}}}catch(e){i.e(e)}finally{i.f()}}};function O(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L,M,N=function e(t){if(a(this,e),d(this,"DomainName",void 0),d(this,"AllcheckoutCompletetionPages",void 0),d(this,"IsExpressCheckoutEnabled",void 0),d(this,"CheckoutPageUrl",void 0),t){this.DomainName=t.domainName,this.CheckoutPageUrl=t.checkoutPageUrl,this.IsExpressCheckoutEnabled=t.isExpressCheckoutEnabled;var r=t.allCheckoutCompletionPagesStr;if(r){var n=JSON.parse(atob(r));this.AllcheckoutCompletetionPages=new Map;var o,i=O(n);try{for(i.s();!(o=i.n()).done;){var l=o.value;if(l){var u=l.Type;u&&this.AllcheckoutCompletetionPages.set(u,new I(l.PageUrl,u,l.checkoutElements))}}}catch(e){i.e(e)}finally{i.f()}}}},D=function e(t,r,n){a(this,e),d(this,"AppInfoClientName",void 0),d(this,"JSVersion",void 0),d(this,"BuildVersion",void 0),this.AppInfoClientName=t,this.JSVersion=r,this.BuildVersion=n},F=function(){function e(){a(this,e)}return u(e,null,[{key:"GetBuildVersion",value:function(){try{var e=navigator.userAgent.match(/Edg\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(e&&e.length>1&&e[0]&&e[0].length>4)return e[0].substr(4)}catch(e){}}}]),e}(),T=function(){function e(){a(this,e),d(this,"heading",void 0),d(this,"price",void 0),d(this,"delivery",void 0),d(this,"soldBy",void 0),d(this,"rating",void 0),d(this,"sellerUrl",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.heading=t.heading,r.price=t.price,r.soldBy=t.soldBy,r.delivery=t.delivery,r.rating=t.rating,r.sellerUrl=t.sellerUrl,r}}]),e}(),G=function(){function e(){a(this,e),d(this,"otherSellers",void 0),d(this,"productImage",void 0),d(this,"productPrice",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.productImage=t.productImage,r.productPrice=t.productPrice,r.otherSellers=new Array,t.otherSellers.forEach((function(e){r.otherSellers.push(e)})),r}}]),e}();function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.CheckoutPageValidationError="CheckoutPageValidationError",e.LogScriptTelemetry="LogScriptTelemetry",e.PageStatus="PageStatus",e.CheckoutPageGMV="CheckoutPageGMV",e.CheckoutPageValidationStatus="CheckoutPageValidationStatus",e.PurchaseCompleted="PurchaseCompleted",e.SetStorageValue="SetStorageValue"}(L||(L={})),function(e){e[e.COUPONS_CLIPPING=0]="COUPONS_CLIPPING",e[e.OTHER_SELLERS=1]="OTHER_SELLERS",e[e.OTHER_SELLERS_CONFIRMATION=2]="OTHER_SELLERS_CONFIRMATION"}(M||(M={}));var B=new Map;B.set(1,new Set(["$","₹","£","€","CA$","CAD$","C$","A$","AU$"])),B.set(3,new Set(["USD","INR","GBP","CAD","EUR","AUD"]));var U=new Map;U.set("en-us","$"),U.set("en-gb","£"),U.set("en-in","₹"),U.set("en-ca","CA$"),U.set("en-au","AU$"),U.set("fr-fr","€"),U.set("de-de","€");var j=new Map;j.set("$","USD"),j.set("₹","INR"),j.set("£","GBP"),j.set("€","EUR"),j.set("CA$","CAD"),j.set("C$","CAD"),j.set("A$","AUD"),j.set("AU$","AUD");var $=function(){function e(){a(this,e),d(this,"traceId",void 0)}var r,n,l;return u(e,[{key:"SetTraceId",value:function(e){this.traceId=e}},{key:"SendValidationMessage",value:function(e,t,r){var n=e?"true":"false",o=[];null!=r&&o.push(r);var i={auto_apply_status:e,express_checkout_status:t,page_validations:o};this.SendMessage(L.PageStatus,[this.traceId,JSON.stringify(i)]),this.SendMessage(L.CheckoutPageValidationStatus,[n,this.traceId])}},{key:"SendStorageMessage",value:function(e,t){this.SendMessage(L.SetStorageValue,[e,t])}},{key:"SendGMVMessage",value:function(e,t){var r,n=null!==(r=j.get(t))&&void 0!==r?r:"USD";this.SendMessage(L.CheckoutPageGMV,[this.traceId,e.toString(),n])}},{key:"SendPurchaseConfirmationMessage",value:function(){this.SendMessage(L.PurchaseCompleted,[this.traceId])}},{key:"SendMessage",value:function(e,t){window.checkoutPageValidatorRuntime.postMessageToHost(e,t)}},{key:"CountMatchingElements",value:function(e){var t,r=0,n=_(e.split(";"));try{for(n.s();!(t=n.n()).done;){var o=t.value,i=this.CountVisibleElements(o);if(i>0){r=i;break}}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"CountVisibleElements",value:function(e){var t,r=0,n=_(this.RunQuerySelectorAll(e));try{for(n.s();!(t=n.n()).done;){var o=t.value;this.IsElementVisible(o)&&r++}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"GetFirstVisibleElement",value:function(e){var t,r=_(this.RunQuerySelectorAll(e));try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.IsElementVisible(n))return n}}catch(e){r.e(e)}finally{r.f()}}},{key:"IsElementVisible",value:function(e){return e&&e.offsetWidth>0&&e.offsetHeight>0}},{key:"RunQuerySelectorAll",value:function(e){var t,r=e.split("<"),n=document.querySelectorAll(r[0]),o=_(r.slice(1));try{for(o.s();!(t=o.n()).done;){var i,a=t.value,l=null===(i=n[0])||void 0===i?void 0:i.shadowRoot;if(!l)return[];n=l.querySelectorAll(a)}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"GetTextValue",value:function(e){var t=e.split(";"),r=this.GetFirstVisibleElement(t[0]),n=r,o=n.innerText;if(1===t.length)o=(n=this.NormalizeIfSuperscripted(r)).innerText;else{var i=this.GetFirstVisibleElement(t[1]);if(i&&i.innerText){var a="."+i.innerText;if(n.contains(i)){var l=n.cloneNode(!0);l.childNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&l.removeChild(e)})),o=null!=l&&l.innerText?l.innerText:o}o+=a}}return this.StripInvalidJSONCharacters(o)}},{key:"StripInvalidJSONCharacters",value:function(e){return e.replace(/\n/gi,"")}},{key:"NormalizeIfSuperscripted",value:function(e){if(e&&e.innerHTML&&e.innerHTML.toLowerCase().indexOf("</sup>")>-1)try{for(var t=e.cloneNode(!0),r=t.childNodes.length,n=0;n<r;n++){var o=t.childNodes[n];if("SUP"===o.tagName){var i=o.innerText,a=/[0-9\.]+/g.exec(i);if(null!==a)return i="."+a[0],o.innerText=i,t}}}catch(t){return e}return e}},{key:"GetBoxValue",value:function(e){if(h.IsValidDataField(e))try{return this.GetTextValue(e)}catch(e){throw Error(e.message)}return""}},{key:"GetOrderTotalString",value:function(e){for(var t=e.split(","),r=0;r<t.length;r++){var n=t[r];try{return this.GetBoxValue(n)}catch(e){if(r===t.length-1)return""}}return""}},{key:"GetInitialFields",value:function(e){var t=[],r=e.retailerData.getCurrentCheckoutPage();r&&[r.inputBoxSelector,r.removeCouponButtonSelector,r.clickBeforeStartSelector,r.layoutClickSelector].forEach((function(e){h.IsValidDataField(e)&&t.push(e)}));return t}},{key:"IsPageValid",value:function(e){var t,r=_(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.CountMatchingElements(n)>0)return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"GetCurrentPathName",value:function(){return location.pathname}},{key:"SendLogEvent",value:function(e,t,r,n,o,i){var a={Currency:o,Domain:this.GetDomainName(window.location.hostname),PageUrl:window.location.toString(),StartingPrice:n,Status:r},l={};l.JsonData=JSON.stringify(a),l.EventType=null!=i?i:"CheckoutPageValidation",l.LogLevel="Information",l.Message=t,l.ClientContext=new D("Edge","1.18",F.GetBuildVersion()),e&&(l.ImpressionId=e);var u=[JSON.stringify(l)];this.SendMessage(L.LogScriptTelemetry,u)}},{key:"SendValidationLog",value:function(e,t,r,n,o){e?r&&-1!==r&&this.SendLogEvent(t,"Checkout Page is Valid","true",r,n):this.SendLogEvent(t,o?"Checkout Page is disabled or does not exist":"Checkout Page is Invalid","false",r,n),r&&-1!==r&&this.SendGMVMessage(r,null!=n?n:"$")}},{key:"GetDomainName",value:function(e){if(!e)return"";var t=e.toLowerCase().match(/(w){3}.?\./);return t&&null!=t.index&&t[0]?e.substring(t.index+t[0].length):e}},{key:"IsECPage",value:(l=t(o().mark((function e(t){var r,n,i,a,l,u,c=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,n=new N(t.checkoutData),i=n.CheckoutPageUrl.split(","),a=!1,i.forEach((function(e){a=a||h.IsOnPage(e,c.GetCurrentPathName())})),!a){e.next=11;break}if(!(u=null==n||null===(l=n.AllcheckoutCompletetionPages)||void 0===l?void 0:l.get("ShippingAddress"))){e.next=11;break}return e.next=11,h.WaitForSyncCondition((function(){return c.IsECElementsExist(u)}),2e3).then((function(e){r=e})).catch((function(e){}));case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"IsECElementsExist",value:function(e){var t=e.CheckoutElements.get("address1");if(t&&t.Value&&this.CountMatchingElements(t.Value)>0)return!0;var r=e.CheckoutElements.get("clickBefore");return!!(r&&r.Value&&this.CountMatchingElements(r.Value)>0)}},{key:"isClippingScenario",value:function(e){if(!e)return!1;var t=this.CountMatchingElements(e.inputBoxSelector)>0,r=this.CountMatchingElements(e.removeCouponButtonSelector)>0;return t&&r}},{key:"isAmazonOtherSellersScenario",value:function(e){var t,r=null==e||null===(t=e.otherSellersSelectors)||void 0===t?void 0:t.otherSellersOverlayLinkSelector;return!(!r||i(r))&&this.CountMatchingElements(r)>0}},{key:"isAmazonOtherSellersConfirmationScenario",value:function(e){if(null!=e&&e.ProductAddedNotification){if((null==e?void 0:e.Url)===this.GetCurrentPathName())return!0;this.ResetOtherSellersNotificationFlag()}return!1}},{key:"ResetOtherSellersNotificationFlag",value:function(){this.SendStorageMessage("OtherSellersNotificationData",JSON.stringify({value:""}))}},{key:"StoreOtherSellersInfo",value:(n=t(o().mark((function e(t){var r,n,i,a,l,u,c,s,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.ValidateAmazonDataFields(t)){e.next=4;break}return e.abrupt("return",!1);case 4:if(r="OtherSellersData",this.SendStorageMessage(r,JSON.stringify({value:null})),e.prev=6,n=t.otherSellersSelectors.otherSellersOverlayLinkSelector,!(i=this.GetFirstVisibleElement(n))){e.next=22;break}if(!(a=i.getAttribute("href"))){e.next=22;break}return u="OtherSellersIframe",c=this.CreateIframe(u,a),document.body.appendChild(c),e.next=17,this.CollectOtherSellersInfo(t,u);case 17:if(!((s=e.sent)&&(null===(l=s.otherSellers)||void 0===l?void 0:l.length)>0)){e.next=22;break}return this.SendStorageMessage(r,JSON.stringify({value:JSON.stringify(s)})),e.abrupt("return",!0);case 22:e.next=29;break;case 24:e.prev=24,e.t0=e.catch(6),h="Error while getting collecting other sellers data. "+e.t0,this.SendLogEvent(this.traceId,h,"error",void 0,void 0,"OtherSellers");case 29:return e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,this,[[6,24]])}))),function(e){return n.apply(this,arguments)})},{key:"CreateIframe",value:function(e,t){var r=document.createElement("iframe");return r.id=e,r.src=t,r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.border="0",r}},{key:"OtherSellerHasLowerPrice",value:function(e,t,r){try{var n=parseFloat(e.replace("$","")),o=parseFloat(t.replace("$","")),i=0,a=r.match(/^\$[0-9.]+/);if(a&&a.length>0&&(i=parseFloat(a[0].replace("$",""))),o+=i,n&&o&&o-n<0)return!0}catch(e){}return!1}},{key:"CollectOtherSellersInfo",value:(r=t(o().mark((function e(r,n){var a,l,u,c,s,d,f,p,v,g,S,m,y,k,C,w,b,E,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(l=new G).otherSellers=[],u=r.otherSellersSelectors,e.next=5,h.WaitForCondition(t(o().mark((function e(){var t,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.querySelectorAll("#"+n)[0],i=null==r||null===(t=r.contentDocument)||void 0===t?void 0:t.body,a=null==i?void 0:i.querySelector(u.otherSellerOfferElementSelector),e.abrupt("return",void 0!==(null==a?void 0:a.innerText));case 4:case"end":return e.stop()}}),e)}))),13e4);case 5:if(c=document.querySelectorAll("#"+n)[0],s=null==c||null===(a=c.contentDocument)||void 0===a?void 0:a.body,d=null==s?void 0:s.querySelectorAll(u.otherSellerOfferElementSelector)){e.next=10;break}return e.abrupt("return",l);case 10:f=this.GetOrderTotalString(r.orderTotalDataElementSelector),l.productPrice=f,p=_(d),e.prev=13,p.s();case 15:if((v=p.n()).done){e.next=35;break}if(S=v.value,m=new T,y=S.querySelector(u.otherSellerPriceSelector),m.price=null==y?void 0:y.innerText,k=S.querySelector(u.otherSellerDeliverySelector),m.delivery=null==k?void 0:k.innerText,this.OtherSellerHasLowerPrice(f,m.price,m.delivery)){e.next=24;break}return e.abrupt("break",35);case 24:C=S.querySelector(u.otherSellerHeadingSelector),w=S.querySelector(u.otherSellerNameSelector),b=S.querySelector(u.otherSellerRatingSelector),E=/a-star-mini-([0-9\-]+)/.test(null==b?void 0:b.className)?RegExp.$1:"-1",m.heading=null==C?void 0:C.innerText,m.soldBy=null==w?void 0:w.innerText,m.sellerUrl=null!==(g=null==w?void 0:w.getAttribute("href"))&&void 0!==g?g:"","-1"!==E&&(m.rating=parseFloat(E.replace("-","."))),l.otherSellers.push(m);case 33:e.next=15;break;case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(13),p.e(e.t0);case 40:return e.prev=40,p.f(),e.finish(40);case 43:return(x=null==s?void 0:s.querySelector(u.productImageSelector))&&!i(x.src)&&(l.productImage=x.src),e.abrupt("return",l);case 48:case"end":return e.stop()}}),e,this,[[13,37,40,43]])}))),function(e,t){return r.apply(this,arguments)})},{key:"ValidateAmazonDataFields",value:function(e){var t=e.otherSellersSelectors;return void 0!==t&&(h.IsValidDataField(t.otherSellersOverlayLinkSelector)&&h.IsValidDataField(t.otherSellerOfferElementSelector)&&h.IsValidDataField(t.otherSellerHeadingSelector)&&h.IsValidDataField(t.otherSellerPriceSelector)&&h.IsValidDataField(t.otherSellerDeliverySelector)&&h.IsValidDataField(t.productImageSelector)&&h.IsValidDataField(t.otherSellerNameSelector)&&h.IsValidDataField(t.otherSellerAddButtonSelector)&&h.IsValidDataField(t.otherSellerAddedConfirmationSelector)&&h.IsValidDataField(t.otherSellerRatingSelector))}}]),e}(),H=function(){function e(){a(this,e)}return u(e,null,[{key:"GetValidatorModule",value:function(){return this.validator||(this.validator=new $),this.validator}}]),e}();d(H,"validator",new $);var J=H,z="";function K(e,t){return q.apply(this,arguments)}function q(){return(q=t(o().mark((function e(r,n){var a,l,u,c,s,d,p,g,S,k,C,w,b,E,x,P,A,I,O;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="",e.prev=1,u=r[0],c=JSON.parse(u),s=te(c),a=null!==(l=s.impressionId)&&void 0!==l?l:"",d=J.GetValidatorModule(),z=r[1],d.SetTraceId(z),p=new y,g=new m,S=!1,k=!1,C=!1,r.length>2)try{(w=r[2])&&((b=new v).CreateFromJsonStr(w),S=b.isExperimentActive(f.expressCheckout),k=b.isExperimentActive(f.showAmazonOtherSellers),C=b.isExperimentActive(f.animationAutoApply))}catch(e){}if(n){e.next=18;break}return C&&W(),e.abrupt("return",!0);case 18:if(r.length>3)try{i(E=r[3])||(p=y.Create(JSON.parse(E)),k&&p.OtherSellersNotificationData&&!i(p.OtherSellersNotificationData)&&(g=m.Create(JSON.parse(p.OtherSellersNotificationData))))}catch(e){x="Error while getting storage data. "+e,J.GetValidatorModule().SendLogEvent(a,x,"error",void 0,void 0,"OtherSellers")}if(P=!1,!S){e.next=31;break}return e.prev=22,e.next=25,d.IsECPage(c);case 25:P=e.sent,e.next=31;break;case 28:e.prev=28,e.t0=e.catch(22);case 31:if(s.retailerData){e.next=36;break}return d.SendValidationMessage(!1,P),d.SendValidationLog(!1,a,void 0,void 0,!0),e.abrupt("return",!1);case 36:if(Y(s,a),A=d.GetCurrentPathName(),s.retailerData.updateCurrentCheckoutPage(A)&&Z(s)){e.next=42;break}return d.SendValidationMessage(!1,P),d.SendValidationLog(!1,a,void 0,void 0,!0),e.abrupt("return",!1);case 42:return I=J.GetValidatorModule().GetInitialFields(s),e.next=45,h.WaitForCondition(t(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=d.IsPageValid(I))&&W(),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))),5e3).then(function(){var e=t(o().mark((function e(t){var r,n,i,l,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.retailerData.getCurrentCheckoutPage(),"amazon.com"!==s.retailerData.domainName){e.next=22;break}if(t=!1,!k||!d.isAmazonOtherSellersConfirmationScenario(g)){e.next=13;break}if(d.SendValidationMessage(t,P,M.OTHER_SELLERS_CONFIRMATION),d.SendValidationLog(t,a,M.OTHER_SELLERS_CONFIRMATION),d.ResetOtherSellersNotificationFlag(),!d.isAmazonOtherSellersScenario(r)){e.next=12;break}return e.next=12,d.StoreOtherSellersInfo(r);case 12:return e.abrupt("return");case 13:if((n=d.isClippingScenario(r))&&(d.SendValidationMessage(t,P,M.COUPONS_CLIPPING),d.SendValidationLog(t,a)),i=!1,!k||!d.isAmazonOtherSellersScenario(r)){e.next=20;break}return e.next=19,d.StoreOtherSellersInfo(r);case 19:i=e.sent;case 20:return n||(l=i?M.OTHER_SELLERS:void 0,d.SendValidationMessage(n,P,l),d.SendValidationLog(n,a)),e.abrupt("return");case 22:d.SendValidationMessage(t,P),e.prev=23,u=s.retailerData.exclusiveMarket,Q(r,u,a,t),e.next=32;break;case 28:return e.prev=28,e.t0=e.catch(23),X(a,null!==(c=null===e.t0||void 0===e.t0?void 0:e.t0.message)&&void 0!==c?c:"checkoutpage GMV error."),e.abrupt("return",!1);case 32:case"end":return e.stop()}}),e,null,[[23,28]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t;X(a,null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"checkoutpage error.")}));case 45:return e.abrupt("return",!1);case 48:return e.prev=48,e.t1=e.catch(1),X(a,null!==(O=null===e.t1||void 0===e.t1?void 0:e.t1.message)&&void 0!==O?O:"checkoutpage error."),e.abrupt("return",!1);case 53:case"end":return e.stop()}}),e,null,[[1,48],[22,28]])})))).apply(this,arguments)}function W(){var e;if(null!==(e=document)&&void 0!==e&&e.body){var t=!1,r="https://www.bing.com/api/shopping/v1/ux/images/autoApply/";window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(t=!0);var n=document.createElement("LINK");n.setAttribute("rel","prefetch"),n.href=t?r+"Shopping_Progress_Dark_01.mp4":r+"Shopping_Progress_01.mp4",n.setAttribute("as","fetch");var o=document.createElement("LINK");o.setAttribute("rel","prefetch"),o.href=t?r+"Shopping_Success_Dark_01.mp4":r+"Shopping_Success_01.mp4",o.setAttribute("as","fetch");var i=document.createElement("LINK");i.setAttribute("rel","prefetch"),i.href=t?r+"Shopping_Finished_Dark_01.mp4":r+"Shopping_Finished_01.mp4",i.setAttribute("as","fetch"),document.body.appendChild(n),document.body.appendChild(o),document.body.appendChild(i)}}function Q(e,r,n,a,l){var u=-1,c="$";e&&h.IsValidDataField(e.orderTotalDataElementSelector)?h.WaitForCondition(t(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ee(e.orderTotalDataElementSelector)>0);case 1:case"end":return t.stop()}}),t)}))),5e3).then((function(){var t=J.GetValidatorModule().GetOrderTotalString(e.orderTotalDataElementSelector);u=function(e,t){if("en-ca"===(null==t?void 0:t.toLocaleLowerCase())){var r=(e=e.trim().replace(/\s/g,"")).lastIndexOf(",");r>-1&&e.length-r-1<=2&&(e=e.replace(/,/g,"."))}var n=parseFloat(e.replace(/[^0-9\.]+/g,""));if(n)return n;return-1}(t,r);var o=function(e){var t=e.replace(/[0-9,.]/g,"");if(!i(t))return t;return"$"}(t);c=function(e,t){if(function(e){if(e){var t=B.get(e.length);if(t)return t.has(e)}return!1}(t))return"en-ca"===(null==e?void 0:e.toLocaleLowerCase())||"en-au"===(null==e?void 0:e.toLocaleLowerCase())?re(e):t;return re(e)}(r,o),l?ne(a,u,c):J.GetValidatorModule().SendValidationLog(a,n,u,c)})).catch((function(e){var t,r=l?"final checkoutpage GMV error.":"checkoutpage GMV error.";X(n,null!==(t=null==e?void 0:e.message)&&void 0!==t?t:r)})):l?ne(a,u,c):J.GetValidatorModule().SendValidationLog(a,n,u,c)}function Y(e,t){try{if(e.retailerData.updateCurrentFinalCheckoutPage(location.pathname)){var r,n=function(e){var t=e.retailerData.getCurrentFinalCheckoutPage();if(t&&!i(t.finalCheckoutButtonSelector))return ee(t.finalCheckoutButtonSelector)>0;return!1}(e);Q(e.retailerData.getCurrentFinalCheckoutPage(),null===(r=e.retailerData)||void 0===r?void 0:r.exclusiveMarket,t,n,!0),n&&function(e){var t=e.retailerData.getCurrentFinalCheckoutPage();if(t&&!i(t.finalCheckoutButtonSelector)){var r=J.GetValidatorModule().GetFirstVisibleElement(t.finalCheckoutButtonSelector);r&&r.addEventListener("click",(function(){J.GetValidatorModule().SendPurchaseConfirmationMessage(),J.GetValidatorModule().SendLogEvent(z,"User completed purchase","completed",void 0,void 0,"PurchaseConfirmation")}))}}(e)}}catch(e){var o;X(t,null!==(o=null==e?void 0:e.message)&&void 0!==o?o:"checkoutpage purchase confirmation error.","PurchaseConfirmation")}}function X(e,t,r){J.GetValidatorModule().SendLogEvent(e,t,"error",void 0,void 0,r),J.GetValidatorModule().SendMessage(L.CheckoutPageValidationError,["error",z])}function Z(e){var t=e.retailerData.getCurrentCheckoutPage();return!!t&&!0===t.edgeEnabled}function ee(e){return J.GetValidatorModule().CountMatchingElements(e)}function te(e){if(e){var t=new g;return e.retailerData&&(t.retailerData=E.Create(e.retailerData)),e.impressionId&&(t.impressionId=e.impressionId),t}return new g}function re(e){if(e){var t=U.get(e);if(t)return t}return"$"}function ne(e,t,r){e?J.GetValidatorModule().SendLogEvent(z,"Valid Final Checkout Page","true",t,r,"PurchaseConfirmation"):t&&-1!==t&&J.GetValidatorModule().SendLogEvent(z,"Invalid Final Checkout Page","false",t,r,"PurchaseConfirmation"),t&&-1!==t&&J.GetValidatorModule().SendGMVMessage(t,null!=r?r:"$")}window.CheckAndIsAutoApplyValid=function(e,t){(function(){try{return window.self!==window.top}catch(e){return!0}})()||K(e,t)},window.IsAutoApplyValid=K;var oe=new S;window.checkoutPageValidatorRuntime=oe}()}();