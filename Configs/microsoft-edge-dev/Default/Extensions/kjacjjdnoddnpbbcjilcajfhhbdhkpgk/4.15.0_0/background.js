(()=>{var Mr=Object.create,ke=Object.defineProperty,Or=Object.getPrototypeOf,Ur=Object.prototype.hasOwnProperty,Nr=Object.getOwnPropertyNames,Lr=Object.getOwnPropertyDescriptor;var qr=t=>ke(t,"__esModule",{value:!0});var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Fr=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Nr(e))!Ur.call(t,s)&&s!=="default"&&ke(t,s,{get:()=>e[s],enumerable:!(r=Lr(e,s))||r.enumerable});return t},de=t=>Fr(qr(ke(t!=null?Mr(Or(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var pe=x((De,at)=>{(function(t,e){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],e);else if(typeof De!="undefined")e(at);else{var r={exports:{}};e(r),t.browser=r.exports}})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:De,function(t){"use strict";if(typeof browser=="undefined"||Object.getPrototypeOf(browser)!==Object.prototype){let e="The message port closed before a response was received.",r="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",s=n=>{let a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(a).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class c extends WeakMap{constructor(d,h=void 0){super(h);this.createItem=d}get(d){return this.has(d)||this.set(d,this.createItem(d)),super.get(d)}}let l=m=>m&&typeof m=="object"&&typeof m.then=="function",o=(m,d)=>(...h)=>{n.runtime.lastError?m.reject(n.runtime.lastError):d.singleCallbackArg||h.length<=1&&d.singleCallbackArg!==!1?m.resolve(h[0]):m.resolve(h)},f=m=>m==1?"argument":"arguments",p=(m,d)=>function(A,...v){if(v.length<d.minArgs)throw new Error(`Expected at least ${d.minArgs} ${f(d.minArgs)} for ${m}(), got ${v.length}`);if(v.length>d.maxArgs)throw new Error(`Expected at most ${d.maxArgs} ${f(d.maxArgs)} for ${m}(), got ${v.length}`);return new Promise((U,L)=>{if(d.fallbackToNoCallback)try{A[m](...v,o({resolve:U,reject:L},d))}catch(_){console.warn(`${m} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,_),A[m](...v),d.fallbackToNoCallback=!1,d.noCallback=!0,U()}else d.noCallback?(A[m](...v),U()):A[m](...v,o({resolve:U,reject:L},d))})},g=(m,d,h)=>new Proxy(d,{apply(A,v,U){return h.call(v,m,...U)}}),u=Function.call.bind(Object.prototype.hasOwnProperty),T=(m,d={},h={})=>{let A=Object.create(null),v={has(L,_){return _ in m||_ in A},get(L,_,q){if(_ in A)return A[_];if(!(_ in m))return;let R=m[_];if(typeof R=="function")if(typeof d[_]=="function")R=g(m,m[_],d[_]);else if(u(h,_)){let X=p(_,h[_]);R=g(m,m[_],X)}else R=R.bind(m);else if(typeof R=="object"&&R!==null&&(u(d,_)||u(h,_)))R=T(R,d[_],h[_]);else if(u(h,"*"))R=T(R,d[_],h["*"]);else return Object.defineProperty(A,_,{configurable:!0,enumerable:!0,get(){return m[_]},set(X){m[_]=X}}),R;return A[_]=R,R},set(L,_,q,R){return _ in A?A[_]=q:m[_]=q,!0},defineProperty(L,_,q){return Reflect.defineProperty(A,_,q)},deleteProperty(L,_){return Reflect.deleteProperty(A,_)}},U=Object.create(m);return new Proxy(U,v)},k=m=>({addListener(d,h,...A){d.addListener(m.get(h),...A)},hasListener(d,h){return d.hasListener(m.get(h))},removeListener(d,h){d.removeListener(m.get(h))}}),$=!1,V=new c(m=>typeof m!="function"?m:function(h,A,v){let U=!1,L,_=new Promise(se=>{L=function(j){$||(console.warn(r,new Error().stack),$=!0),U=!0,se(j)}}),q;try{q=m(h,A,L)}catch(se){q=Promise.reject(se)}let R=q!==!0&&l(q);if(q!==!0&&!R&&!U)return!1;let X=se=>{se.then(j=>{v(j)},j=>{let Ie;j&&(j instanceof Error||typeof j.message=="string")?Ie=j.message:Ie="An unexpected error occurred",v({__mozWebExtensionPolyfillReject__:!0,message:Ie})}).catch(j=>{console.error("Failed to send onMessage rejected reply",j)})};return X(R?q:_),!0}),O=({reject:m,resolve:d},h)=>{n.runtime.lastError?n.runtime.lastError.message===e?d():m(n.runtime.lastError):h&&h.__mozWebExtensionPolyfillReject__?m(new Error(h.message)):d(h)},ue=(m,d,h,...A)=>{if(A.length<d.minArgs)throw new Error(`Expected at least ${d.minArgs} ${f(d.minArgs)} for ${m}(), got ${A.length}`);if(A.length>d.maxArgs)throw new Error(`Expected at most ${d.maxArgs} ${f(d.maxArgs)} for ${m}(), got ${A.length}`);return new Promise((v,U)=>{let L=O.bind(null,{resolve:v,reject:U});A.push(L),h.sendMessage(...A)})},H={runtime:{onMessage:k(V),onMessageExternal:k(V),sendMessage:ue.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:ue.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},J={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":J},services:{"*":J},websites:{"*":J}},T(n,H,a)};if(typeof chrome!="object"||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");t.exports=s(chrome)}else t.exports=browser})});var Pe=x((Ns,ot)=>{"use strict";ot.exports=function(e,r){return function(){for(var n=new Array(arguments.length),a=0;a<n.length;a++)n[a]=arguments[a];return e.apply(r,n)}}});var B=x((Ls,lt)=>{"use strict";var Hr=Pe(),Z=Object.prototype.toString;function ct(t){return Z.call(t)==="[object Array]"}function Be(t){return typeof t=="undefined"}function Wr(t){return t!==null&&!Be(t)&&t.constructor!==null&&!Be(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function $r(t){return Z.call(t)==="[object ArrayBuffer]"}function jr(t){return typeof FormData!="undefined"&&t instanceof FormData}function Gr(t){var e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function Kr(t){return typeof t=="string"}function Yr(t){return typeof t=="number"}function ut(t){return t!==null&&typeof t=="object"}function zr(t){return Z.call(t)==="[object Date]"}function Vr(t){return Z.call(t)==="[object File]"}function Jr(t){return Z.call(t)==="[object Blob]"}function dt(t){return Z.call(t)==="[object Function]"}function Xr(t){return ut(t)&&dt(t.pipe)}function Zr(t){return typeof URLSearchParams!="undefined"&&t instanceof URLSearchParams}function Qr(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function es(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function me(t,e){if(!(t===null||typeof t=="undefined"))if(typeof t!="object"&&(t=[t]),ct(t))for(var r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.call(null,t[n],n,t)}function pt(){var t={};function e(n,a){typeof t[a]=="object"&&typeof n=="object"?t[a]=pt(t[a],n):t[a]=n}for(var r=0,s=arguments.length;r<s;r++)me(arguments[r],e);return t}function Me(){var t={};function e(n,a){typeof t[a]=="object"&&typeof n=="object"?t[a]=Me(t[a],n):typeof n=="object"?t[a]=Me({},n):t[a]=n}for(var r=0,s=arguments.length;r<s;r++)me(arguments[r],e);return t}function ts(t,e,r){return me(e,function(n,a){r&&typeof n=="function"?t[a]=Hr(n,r):t[a]=n}),t}lt.exports={isArray:ct,isArrayBuffer:$r,isBuffer:Wr,isFormData:jr,isArrayBufferView:Gr,isString:Kr,isNumber:Yr,isObject:ut,isUndefined:Be,isDate:zr,isFile:Vr,isBlob:Jr,isFunction:dt,isStream:Xr,isURLSearchParams:Zr,isStandardBrowserEnv:es,forEach:me,merge:pt,deepMerge:Me,extend:ts,trim:Qr}});var Oe=x((qs,mt)=>{"use strict";var Q=B();function ft(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}mt.exports=function(e,r,s){if(!r)return e;var n;if(s)n=s(r);else if(Q.isURLSearchParams(r))n=r.toString();else{var a=[];Q.forEach(r,function(o,f){o===null||typeof o=="undefined"||(Q.isArray(o)?f=f+"[]":o=[o],Q.forEach(o,function(g){Q.isDate(g)?g=g.toISOString():Q.isObject(g)&&(g=JSON.stringify(g)),a.push(ft(f)+"="+ft(g))}))}),n=a.join("&")}if(n){var c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+n}return e}});var ht=x((Fs,gt)=>{"use strict";var rs=B();function fe(){this.handlers=[]}fe.prototype.use=function(e,r){return this.handlers.push({fulfilled:e,rejected:r}),this.handlers.length-1};fe.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};fe.prototype.forEach=function(e){rs.forEach(this.handlers,function(s){s!==null&&e(s)})};gt.exports=fe});var At=x((Hs,_t)=>{"use strict";var ss=B();_t.exports=function(e,r,s){return ss.forEach(s,function(a){e=a(e,r)}),e}});var Ue=x((Ws,xt)=>{"use strict";xt.exports=function(e){return!!(e&&e.__CANCEL__)}});var wt=x(($s,yt)=>{"use strict";var ns=B();yt.exports=function(e,r){ns.forEach(e,function(n,a){a!==r&&a.toUpperCase()===r.toUpperCase()&&(e[r]=n,delete e[a])})}});var Tt=x((js,Et)=>{"use strict";Et.exports=function(e,r,s,n,a){return e.config=r,s&&(e.code=s),e.request=n,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}});var Ne=x((Gs,vt)=>{"use strict";var is=Tt();vt.exports=function(e,r,s,n,a){var c=new Error(e);return is(c,r,s,n,a)}});var St=x((Ks,bt)=>{"use strict";var as=Ne();bt.exports=function(e,r,s){var n=s.config.validateStatus;!n||n(s.status)?e(s):r(as("Request failed with status code "+s.status,s.config,null,s.request,s))}});var Ct=x((Ys,Rt)=>{"use strict";Rt.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}});var kt=x((zs,It)=>{"use strict";It.exports=function(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e}});var Pt=x((Vs,Dt)=>{"use strict";var os=Ct(),ls=kt();Dt.exports=function(e,r){return e&&!os(r)?ls(e,r):r}});var Mt=x((Js,Bt)=>{"use strict";var Le=B(),cs=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];Bt.exports=function(e){var r={},s,n,a;return e&&Le.forEach(e.split(`
`),function(l){if(a=l.indexOf(":"),s=Le.trim(l.substr(0,a)).toLowerCase(),n=Le.trim(l.substr(a+1)),s){if(r[s]&&cs.indexOf(s)>=0)return;s==="set-cookie"?r[s]=(r[s]?r[s]:[]).concat([n]):r[s]=r[s]?r[s]+", "+n:n}}),r}});var Nt=x((Xs,Ot)=>{"use strict";var Ut=B();Ot.exports=Ut.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),s;function n(a){var c=a;return e&&(r.setAttribute("href",c),c=r.href),r.setAttribute("href",c),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return s=n(window.location.href),function(c){var l=Ut.isString(c)?n(c):c;return l.protocol===s.protocol&&l.host===s.host}}():function(){return function(){return!0}}()});var qt=x((Zs,Lt)=>{"use strict";var ge=B();Lt.exports=ge.isStandardBrowserEnv()?function(){return{write:function(r,s,n,a,c,l){var o=[];o.push(r+"="+encodeURIComponent(s)),ge.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ge.isString(a)&&o.push("path="+a),ge.isString(c)&&o.push("domain="+c),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read:function(r){var s=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var Fe=x((Qs,Ft)=>{"use strict";var he=B(),us=St(),ds=Oe(),ps=Pt(),ms=Mt(),fs=Nt(),qe=Ne();Ft.exports=function(e){return new Promise(function(s,n){var a=e.data,c=e.headers;he.isFormData(a)&&delete c["Content-Type"];var l=new XMLHttpRequest;if(e.auth){var o=e.auth.username||"",f=e.auth.password||"";c.Authorization="Basic "+btoa(o+":"+f)}var p=ps(e.baseURL,e.url);if(l.open(e.method.toUpperCase(),ds(p,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,l.onreadystatechange=function(){if(!(!l||l.readyState!==4)&&!(l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0))){var k="getAllResponseHeaders"in l?ms(l.getAllResponseHeaders()):null,$=!e.responseType||e.responseType==="text"?l.responseText:l.response,V={data:$,status:l.status,statusText:l.statusText,headers:k,config:e,request:l};us(s,n,V),l=null}},l.onabort=function(){!l||(n(qe("Request aborted",e,"ECONNABORTED",l)),l=null)},l.onerror=function(){n(qe("Network Error",e,null,l)),l=null},l.ontimeout=function(){var k="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(k=e.timeoutErrorMessage),n(qe(k,e,"ECONNABORTED",l)),l=null},he.isStandardBrowserEnv()){var g=qt(),u=(e.withCredentials||fs(p))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;u&&(c[e.xsrfHeaderName]=u)}if("setRequestHeader"in l&&he.forEach(c,function(k,$){typeof a=="undefined"&&$.toLowerCase()==="content-type"?delete c[$]:l.setRequestHeader($,k)}),he.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),e.responseType)try{l.responseType=e.responseType}catch(T){if(e.responseType!=="json")throw T}typeof e.onDownloadProgress=="function"&&l.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(k){!l||(l.abort(),n(k),l=null)}),a===void 0&&(a=null),l.send(a)})}});var He=x((en,Ht)=>{"use strict";var M=B(),Wt=wt(),gs={"Content-Type":"application/x-www-form-urlencoded"};function $t(t,e){!M.isUndefined(t)&&M.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function hs(){var t;return typeof XMLHttpRequest!="undefined"?t=Fe():typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]"&&(t=Fe()),t}var _e={adapter:hs(),transformRequest:[function(e,r){return Wt(r,"Accept"),Wt(r,"Content-Type"),M.isFormData(e)||M.isArrayBuffer(e)||M.isBuffer(e)||M.isStream(e)||M.isFile(e)||M.isBlob(e)?e:M.isArrayBufferView(e)?e.buffer:M.isURLSearchParams(e)?($t(r,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):M.isObject(e)?($t(r,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if(typeof e=="string")try{e=JSON.parse(e)}catch(r){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};_e.headers={common:{Accept:"application/json, text/plain, */*"}};M.forEach(["delete","get","head"],function(e){_e.headers[e]={}});M.forEach(["post","put","patch"],function(e){_e.headers[e]=M.merge(gs)});Ht.exports=_e});var Kt=x((tn,jt)=>{"use strict";var Gt=B(),We=At(),_s=Ue(),As=He();function $e(t){t.cancelToken&&t.cancelToken.throwIfRequested()}jt.exports=function(e){$e(e),e.headers=e.headers||{},e.data=We(e.data,e.headers,e.transformRequest),e.headers=Gt.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Gt.forEach(["delete","get","head","post","put","patch","common"],function(n){delete e.headers[n]});var r=e.adapter||As.adapter;return r(e).then(function(n){return $e(e),n.data=We(n.data,n.headers,e.transformResponse),n},function(n){return _s(n)||($e(e),n&&n.response&&(n.response.data=We(n.response.data,n.response.headers,e.transformResponse))),Promise.reject(n)})}});var je=x((rn,Yt)=>{"use strict";var K=B();Yt.exports=function(e,r){r=r||{};var s={},n=["url","method","params","data"],a=["headers","auth","proxy"],c=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];K.forEach(n,function(p){typeof r[p]!="undefined"&&(s[p]=r[p])}),K.forEach(a,function(p){K.isObject(r[p])?s[p]=K.deepMerge(e[p],r[p]):typeof r[p]!="undefined"?s[p]=r[p]:K.isObject(e[p])?s[p]=K.deepMerge(e[p]):typeof e[p]!="undefined"&&(s[p]=e[p])}),K.forEach(c,function(p){typeof r[p]!="undefined"?s[p]=r[p]:typeof e[p]!="undefined"&&(s[p]=e[p])});var l=n.concat(a).concat(c),o=Object.keys(r).filter(function(p){return l.indexOf(p)===-1});return K.forEach(o,function(p){typeof r[p]!="undefined"?s[p]=r[p]:typeof e[p]!="undefined"&&(s[p]=e[p])}),s}});var Xt=x((sn,zt)=>{"use strict";var Ae=B(),xs=Oe(),Vt=ht(),ys=Kt(),Jt=je();function ne(t){this.defaults=t,this.interceptors={request:new Vt,response:new Vt}}ne.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=Jt(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var r=[ys,void 0],s=Promise.resolve(e);for(this.interceptors.request.forEach(function(a){r.unshift(a.fulfilled,a.rejected)}),this.interceptors.response.forEach(function(a){r.push(a.fulfilled,a.rejected)});r.length;)s=s.then(r.shift(),r.shift());return s};ne.prototype.getUri=function(e){return e=Jt(this.defaults,e),xs(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};Ae.forEach(["delete","get","head","options"],function(e){ne.prototype[e]=function(r,s){return this.request(Ae.merge(s||{},{method:e,url:r}))}});Ae.forEach(["post","put","patch"],function(e){ne.prototype[e]=function(r,s,n){return this.request(Ae.merge(n||{},{method:e,url:r,data:s}))}});zt.exports=ne});var Ke=x((nn,Zt)=>{"use strict";function Ge(t){this.message=t}Ge.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Ge.prototype.__CANCEL__=!0;Zt.exports=Ge});var er=x((an,Qt)=>{"use strict";var ws=Ke();function xe(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(n){e=n});var r=this;t(function(n){r.reason||(r.reason=new ws(n),e(r.reason))})}xe.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};xe.source=function(){var e,r=new xe(function(n){e=n});return{token:r,cancel:e}};Qt.exports=xe});var rr=x((on,tr)=>{"use strict";tr.exports=function(e){return function(s){return e.apply(null,s)}}});var ir=x((ln,Ye)=>{"use strict";var sr=B(),Es=Pe(),ye=Xt(),Ts=je(),vs=He();function nr(t){var e=new ye(t),r=Es(ye.prototype.request,e);return sr.extend(r,ye.prototype,e),sr.extend(r,e),r}var G=nr(vs);G.Axios=ye;G.create=function(e){return nr(Ts(G.defaults,e))};G.Cancel=Ke();G.CancelToken=er();G.isCancel=Ue();G.all=function(e){return Promise.all(e)};G.spread=rr();Ye.exports=G;Ye.exports.default=G});var or=x((cn,ar)=>{ar.exports=ir()});var i=de(pe());var lr=de(or()),we=lr.default.create({baseURL:"https://c88fef96.forestapp.cc/api/v1"}),cr=()=>we({method:"GET",url:"/tree_types/unlocked"});var ur=t=>we({method:"GET",url:`users/${t}/boost`}),dr=(t,e)=>we({method:"GET",url:"/plants/updated_plants",params:{update_since:t,authenticate_token:e}}),pr=()=>we({method:"DELETE",url:"/sessions/signout",data:"null"});var bs=de(pe()),F=(t,e)=>t.classList.add(e),C=(t,e)=>t.classList.remove(e);var mr="UPDATE_SETTINGS_UI",fr="BLOCK_CONTENT",gr="HIDE_OVERLAY",hr="FAILED";var Ee="UPDATE_OPTIONS_MODE_SWITCHER",_r="LOCK_POPUP_MODE_SWITCHER",Ar="UNLOCK_POPUP_MODE_SWITCHER";var xr=t=>({type:mr,payload:t}),ie=({timerText:t,treeUrl:e})=>({type:fr,payload:{timerText:t,treeUrl:e}}),yr=()=>({type:gr}),wr=(t,e)=>({type:hr,payload:{timerText:t,treeUrl:e}});var Er=()=>({type:Ee}),Tr=()=>({type:_r}),Te=t=>({type:Ar,payload:t});var E={READY:"ready",GROWING:"growing",GROWN:"grown",FAILED:"failed"};var vr=de(pe()),br=[...Array(8)].map((t,e)=>({tag_id:e,title:vr.default.i18n.getMessage(`plant_tag_${e}`)}));var b=[{id:0,name:"Cedar",prefix:"tree_default",type:"TREE",special_childhood:[],has_seven:!0,product_id:-1},{id:1,name:"Flower Tree",prefix:"flower_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:1},{id:2,name:"Tree House",prefix:"tree_house",type:"TREE",special_childhood:[],has_seven:!0,product_id:2},{id:3,name:"Nest",prefix:"bird_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:3},{id:4,name:"Lemon Tree",prefix:"lemon_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:6},{id:5,name:"Triplets",prefix:"castle_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:7},{id:6,name:"Bush",prefix:"flower_bush",type:"BUSH",special_childhood:[],has_seven:!1,product_id:-1},{id:7,name:"Octopus",prefix:"octopus",type:"TREE",special_childhood:[],has_seven:!0,product_id:10},{id:8,name:"Cherry Blossom",prefix:"cherry_blossom",type:"TREE",special_childhood:[],has_seven:!0,product_id:11},{id:9,name:"Coconut Tree",prefix:"coconut_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:12},{id:10,name:"Cat Tree",prefix:"cat_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:13},{id:11,name:"Grass",prefix:"grass",type:"BUSH",special_childhood:[],has_seven:!1,product_id:14},{id:12,name:"Pine Tree",prefix:"pine_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:15},{id:13,name:"Cactus Ball",prefix:"cactus_ball",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:16},{id:14,name:"Pumpkin",prefix:"pumpkin",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:22},{id:15,name:"Scarecrow",prefix:"scarecrow",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:23},{id:18,name:"Mushroom",prefix:"mushroom",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:24},{id:19,name:"Big Cactus",prefix:"big_cactus",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:25},{id:20,name:"Ginkgo Tree",prefix:"ginkgo",type:"TREE",special_childhood:[],has_seven:!0,product_id:27},{id:21,name:"Wisteria Tree",prefix:"wisteria_tree",type:"TREE",special_childhood:[],has_seven:!0,product_id:28},{id:22,name:"Watermelon",prefix:"watermelon",type:"BUSH",special_childhood:[2],has_seven:!1,product_id:29},{id:23,name:"Bamboo",prefix:"bamboo",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:30},{id:24,name:"Candy Tree",prefix:"candy_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:31},{id:25,name:"SunFlower",prefix:"sunflower",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:32},{id:26,name:"Rose",prefix:"rose",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:33},{id:27,name:"Maple",prefix:"maple",type:"TREE",special_childhood:[],has_seven:!0,product_id:34},{id:28,name:"BaobabTree",prefix:"baobab_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:35},{id:29,name:"Raffelesia",prefix:"rafflesia",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:36},{id:30,name:"Banana Tree",prefix:"banana_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:37},{id:31,name:"New Year Bamboo",prefix:"new_year_bamboo",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:38},{id:32,name:"Earth Tree",prefix:"earth_tree",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:39},{id:33,name:"Carnation",prefix:"Carnation",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:40},{id:34,name:"Apple Tree",prefix:"apple_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:41},{id:35,name:"Star Tree",prefix:"star_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:42},{id:36,name:"Time Tree",prefix:"time_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:43},{id:37,name:"Moon Tree",prefix:"moon_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:44},{id:38,name:"Rainbow Flower",prefix:"rainbow_flower",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:45},{id:39,name:"Ghost Mushroom",prefix:"ghost_mushroom",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:46},{id:40,name:"Blue Mail Tree",prefix:"mail_tree_blue",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:47},{id:41,name:"Green Mail Tree",prefix:"mail_tree_green",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:48},{id:42,name:"Pink Mail Tree",prefix:"mail_tree_pink",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:49},{id:43,name:"Yellow Mail Tree",prefix:"mail_tree_yellow",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:50},{id:44,name:"Purple Mail Tree",prefix:"mail_tree_purple",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:51},{id:45,name:"Cattail Willow",prefix:"cattail_willow",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:52},{id:46,name:"Clear Note Flower",prefix:"clear_note_flower",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:53},{id:47,name:"Coral",prefix:"coral",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:54},{id:48,name:"Cake Flower Chocolate",prefix:"cake_flower_chocolate",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:62},{id:49,name:"Cake Flower Cheese",prefix:"cake_flower_cheese",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:63},{id:50,name:"Cake Flower Tiramisu",prefix:"cake_flower_tiramisu",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:64},{id:51,name:"Cake Flower Matcha",prefix:"cake_flower_matcha",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:65},{id:52,name:"Cake Flower Lemon",prefix:"cake_flower_lemon",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:66},{id:53,name:"Cake Flower Black",prefix:"cake_flower_black",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:67},{id:54,name:"Cake Flower Blueberry",prefix:"cake_flower_blueberry",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:68},{id:55,name:"Cake Flower Strawberry",prefix:"cake_flower_strawberry",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:69},{id:56,name:"Birthday2019CakeTree",prefix:"cake_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:55},{id:57,name:"Dog Tree",prefix:"dog_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:56},{id:58,name:"Bear Paw",prefix:"bear_paw",type:"BUSH",special_childhood:[1,2],has_seven:!1,product_id:57},{id:59,name:"Starburst Bush",prefix:"starburst_bush",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:59},{id:60,name:"Unicorn Tree",prefix:"unicorn_tree",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:60},{id:61,name:"Space Tree",prefix:"space_tree",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:61},{id:62,name:"Celestial Tree",prefix:"celestial_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:81},{id:63,name:"Weepingwillow Tree",prefix:"weepingwillow_tree",type:"TREE",special_childhood:[1,2],has_seven:!0,product_id:82},{id:64,name:"Clover",prefix:"clover",type:"TREE",special_childhood:[1,2],has_seven:!1,product_id:84},{id:65,name:"Eco Tree",prefix:"eco_tree",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:66,name:"Birthday 2020 tree",prefix:"birthday_2020_tree",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:67,name:"Water Spirit",prefix:"water_spirit",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:68,name:"Sundae Tree",prefix:"sundae_tree",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:69,name:"Lover Tree",prefix:"lover_tree",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:70,name:"Pear tree house",prefix:"pear_tree_house",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:71,name:"Witch Mushroom",prefix:"witch_mushroom",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:72,name:"Lily Flower",prefix:"lily_flower",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:73,name:"Twilight Guardian",prefix:"twilight_guardian",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:74,name:"Tulip",prefix:"tulip",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:75,name:"Plum Blossom",prefix:"plum_blossom",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:76,name:"Camellia",prefix:"camellia",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:77,name:"Luminie",prefix:"luminie",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:78,name:"Birthday 2021",prefix:"birthday_2021_tree",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:79,name:"Lavender",prefix:"lavender",type:"TREE",special_childhood:[1,2],has_seven:!0},{id:80,name:"Rice",prefix:"rice",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:81,name:"Tada Statue",prefix:"statue_of_tada",type:"TREE",special_childhood:[1,2],has_seven:!1},{id:-1,name:"dummy",prefix:"dummy",product_id:-1}],Sr=[31,32,41,42,43,44,46,47,48,49,50,51,52,53,54,55,56,59,60,61,66,70,73,77,78,81];window.currentState=E.READY;var D=1500,ze=0,N=D,ve,Ve,Rr,Cr=0,be,ae,Je,I=!1,Xe=!1,Ze=!1,Qe=!0,Ir,ee=[],w=0,oe=null;window.getDefaultWhitelist=()=>["wikipedia.org"];window.getDefaultBlacklist=()=>["facebook.com","reddit.com","youtube.com"];function S(t,e){try{let r=i.default.extension.getViews({type:"popup"});r.length>0&&t(r[0],e)}catch(r){}}window.saveLastTreeTagId=t=>{ze=t,i.default.storage.local.set({lastTreeTagId:t})};var Ss=async()=>{let{user:t}=await i.default.storage.local.get({user:null});if(!t)return!1;let{user_id:e}=t,{data:r}=await ur(e),{boost_rate:s,boost_end_time:n}=r;return!n||new Date(n)-Date.now()<0?!1:s||!1};function Rs(){(async()=>{var e=(await i.default.storage.local.get({user:null})).user,r=new Date().toISOString(),s=null;e!==null&&(s=e.remember_token);for(var n=[],a=0;a<et(tt(D));++a)n.push({tree_type:w,is_dead:!0,position:0,phase:8});i.default.storage.local.set({planting:{plant:{start_time:r,end_time:r,is_success:!1,tag:ze,note:i.default.i18n.getMessage(`main_planting_note_${window.browser?"firefox":"chrome"}`),trees:n},authenticate_token:s}})})()}function rt(t,e){(async()=>{let r=await i.default.storage.local.get({grownTree:null,user:null,lastUpdateTime:"2017-08-15T03:14:56.840Z"});if(r.grownTree!=null&&r.grownTree.length!=0){var s=r.grownTree,n=new Array,a=r.user,c=r.lastUpdateTime,l=new Date(c);c=new Date(l.getTime()-1e6);var o;if(s!=null&&a!=null)try{let{data:g}=await dr(c.toISOString(),a.remember_token);o=g.plants,f()}catch(g){e()}}else e();function f(){var g=s.shift();typeof g=="undefined"?(async()=>{await i.default.storage.local.set({grownTree:n}),await i.default.storage.local.remove("lastUpdateTime"),e()})():p(g,()=>f())}function p(g,u){if(t=="update")if(typeof g.plant.id!="undefined"&&g.plant.id!=null){var T=o.find(k=>k.id==g.plant.id);g.plant.tag=T.tag,g.plant.note=T.note,n.push(g),u()}else n.push(g),u();else t=="login"&&(typeof g.plant.user_id=="undefined"||g.plant.user_id==a.user_id||g.plant.user_id==null)&&n.push(g),u()}})()}window.updateFromServer=rt;function le(t,e){(async()=>{let r=await i.default.storage.local.get({planting:null,grownTree:null,user:null,uploadCache:null,IDtemp:1,lastUpdateTime:null});var s=new Array,n=new Array,a=r.planting,c=null,l=r.uploadCache,o=parseInt(r.IDtemp),f=r.lastUpdateTime;switch(r.user!=null&&(c=r.user.remember_token),t){case"grown":Ze?(async()=>{await i.default.storage.local.set({uploadCache:a}),i.default.storage.local.remove("planting")})():g(a,async()=>{r.grownTree!=null&&(n=n.concat(r.grownTree)),await i.default.storage.local.set({grownTree:n,IDtemp:o}),rt("update",()=>e()),i.default.storage.local.remove("planting")});break;case"sync":Ze=!0,r.grownTree!=null&&(s=r.grownTree),p();break;case"cache":l!=null?g(l,async()=>{r.grownTree!=null&&(n=n.concat(r.grownTree)),i.default.storage.local.set({grownTree:n,IDtemp:o}),i.default.storage.local.remove("uploadCache"),e()}):e();break;default:break}function p(){var u=s.shift();typeof u=="undefined"?(async()=>{await i.default.storage.local.set({grownTree:n,IDtemp:o,lastUpdateTime:f}),Ze=!1,le("cache",()=>rt("update",()=>e()))})():g(u,()=>p())}function g(u,T){if(u!==null)if(u.syncState=="Success"){var k=u.plant.updated_at;if(f==null)f=k;else{var $=new Date(f),V=new Date(k);$>V&&(f=k)}n.push(u),T()}else{var O=new XMLHttpRequest;if(typeof u.plant.id=="undefined"||u.plant.id==null)O.open("POST","https://c88fef96.forestapp.cc/api/v1/plants",!0);else if(u.syncState=="WaitForSync"||u.syncState=="EditFail"){var ue="https://c88fef96.forestapp.cc/api/v1/plants/"+u.plant.id;O.open("PUT",ue,!0)}else O.open("POST","https://c88fef96.forestapp.cc/api/v1/plants",!0);var H=JSON.parse(JSON.stringify(u));H.authenticate_token=c;for(var J in H.plant.trees)H.plant.trees[J].tree_type=b[u.plant.trees[J].tree_type].id;(typeof H.syncState!="undefined"||typeof H.failedStatus!="undefined")&&(delete H.browserTreeID,delete H.syncState,delete H.failedStatus);var m=JSON.stringify(H);O.setRequestHeader("Content-type","application/json; charset=utf-8"),O.onreadystatechange=()=>{var d;if(O.readyState==4)if(O.status==200){d=JSON.parse(O.responseText),u.syncState="Success",u.plant.user_id=d.user_id,u.plant.id=d.id,u.plant.updated_at=d.updated_at;var h=u.plant.updated_at;if(f==null&&typeof h!="undefined")f=h;else{var A=new Date(f),v=new Date(h);A>v&&(f=h)}u.failedStatus="200",(typeof u.browserTreeID=="undefined"||u.browserTreeID==null)&&(u.browserTreeID=o,o++),n.length>=100&&n.pop(),n.push(u),T()}else n.length>=100&&n.pop(),typeof u.plant.id=="undefined"||u.plant.id==null?u.syncState="Fail":u.syncState=="WaitForSync"||u.syncState=="EditFail"?u.syncState="EditFail":u.syncState="Fail",u.failedStatus="422",(typeof u.browserTreeID=="undefined"||u.browserTreeID==null)&&(u.browserTreeID=o,o++),n.push(u),O.status==403?(async()=>{await i.default.storage.local.remove("user"),c=null,u.failedStatus="403",T()})():(O.status==0&&(u.failedStatus="0"),T())},O.send(m)}}})()}window.uploadTree=le;function et(t){var e=t-3;return e>=0?e:0}function tt(t){return D<1500?Math.floor(t/(D/3))+1:t<600?1:t<1200?2:t<1500?3:t<3600?4:t<5400?5:t<7200?6:7}function st(){var t=D-N;return tt(t)}function Se(){currentState=E.READY,N=D}function te(){if(N<0)return"";var t=Math.floor(N/60),e=Math.floor(N%60);return(t>=10?"":"0")+t+":"+(e>=10?"":"0")+e}var y=t=>S(e=>F(e.document.getElementById(t),"hidden")),P=t=>S(e=>C(e.document.getElementById(t),"hidden")),re=t=>S(e=>F(e.document.getElementById(t),"disappear")),ce=t=>S(e=>C(e.document.getElementById(t),"disappear"));function Cs(){var t=te();currentState==E.READY||currentState==E.GROWING?re("share-icons"):(t="",ce("share-icons")),S(e=>e.document.getElementById("timer").textContent=t)}function nt(t){return b[t].product_id==-1?!0:ee.find(({gid:r})=>r===b[t].id)!==void 0}function Is(t){var e=Math.floor(t/60),r=4,s=1,n=5;return t<25*60&&(r=1),r+Math.floor(e/5)*s+Math.max(Math.floor(e/30)-1,0)*n}function ks(t){Qe=!0,S(function(e){var r=e.document.getElementById("finish-popup");F(r,"finish-popup-shrink");var s=e.document.getElementById("finish-mask");C(s,"finish-masked")}),window.setTimeout(()=>{y("finish-popup"),y("finish-mask")},300),t&&(t=!0,i.default.storage.local.set({doNotShowFinishMessageForGuest:!0}))}window.onClickFinishConfirmedButton=ks;function W(){var t,e,r,s=st();switch(y("timer-left-arrow"),y("timer-right-arrow"),y("treeball-left-arrow"),y("treeball-right-arrow"),currentState){case E.READY:var n=tt(D);if(n<3&&b[w].special_childhood!==void 0)if(b[w].special_childhood.includes(parseInt(n))){let{id:o,prefix:f}=b[w];t=`./images/trees/tree${o+1}/${f}_${n}.png`}else t=`./images/trees/tree1/tree_default_${n}.png`;else{let{id:o,prefix:f,has_seven:p}=b[w];t=`./images/trees/tree${o+1}/${f}_${p?n:"4"}.png`}nt(w)?(y("locker"),S(o=>C(o.document.getElementById("tree"),"shadowed-tree")),r=i.default.i18n.getMessage("main_top_description_ready")):(P("locker"),S(o=>F(o.document.getElementById("tree"),"shadowed-tree")),r=i.default.i18n.getMessage("main_top_description_locked")),P("timer-container"),P("tree"),P("seed"),P("timer-left-arrow"),P("timer-right-arrow"),P("treeball-left-arrow"),P("treeball-right-arrow"),S(function(o){F(o.document.getElementById("treeball"),"tree-cursor"),F(o.document.getElementById("seed"),"tree-cursor"),F(o.document.getElementById("tree"),"tree-cursor")}),i.default.runtime.sendMessage(Te(I?"white":"black")).catch(()=>{});break;case E.GROWING:if(s<3)typeof b[w].special_childhood=="undefined"?t=`./images/trees/tree1/tree_default_${s}.png`:b[w].special_childhood.includes(parseInt(s))?t="./images/trees/tree"+(b[w].id+1)+"/"+b[w].prefix+"_"+s+".png":t=`./images/trees/tree1/tree_default_${s}.png`;else{let{id:o,prefix:f,has_seven:p}=b[w];t=`./images/trees/tree${o+1}/${f}_${p?s:"4"}.png`}P("timer-container"),y("seed"),P("tree"),y("plant-board"),y("plant-board-text"),N%10==0&&(Cr=Math.floor(Math.random()*13)),r=i.default.i18n.getMessage("main_message_growing_text_"+Cr),S(o=>{F(o.document.getElementById("finish-popup"),"finish-popup-shrink"),C(o.document.getElementById("treeball"),"tree-cursor"),C(o.document.getElementById("seed"),"tree-cursor"),C(o.document.getElementById("tree"),"tree-cursor")}),i.default.runtime.sendMessage(Tr()).catch(()=>{});break;case E.GROWN:let{id:a,prefix:c,has_seven:l}=b[w];t=`./images/trees/tree${a+1}/${c}_${l?s:"4"}.png`,y("timer-container"),y("seed"),P("tree"),y("plant-board"),y("plant-board-text"),r=i.default.i18n.getMessage("main_top_description_grown"),Qe?(y("finish-popup"),y("finish-mask")):(P("finish-popup"),P("finish-mask"),P("do-not-show-finish-message-container"),P("finish-message-for-guest-container"),P("finish-message-for-user-container"),S(o=>{F(o.document.getElementById("edit-popup"),"edit-popup-shrink"),C(o.document.getElementById("edit-mask"),"edit-masked")}),window.setTimeout(()=>{y("edit-mask"),y("edit-popup")},300),S(o=>F(o.document.getElementById("finish-mask"),"finish-masked")),Xe?(y("do-not-show-finish-message-container"),y("finish-message-for-guest-container"),S(async o=>{let f=await Ss(),p=Is(D),g=o.document.querySelector("#coins-boosted");g.textContent="",f&&(g.textContent=`+${(f-1)*p}`),o.document.getElementById("coins-for-user").textContent=p,F(o.document.getElementById("finish-popup"),"finish-popup-for-user-width")})):(y("finish-message-for-user-container"),S(o=>C(o.document.getElementById("finish-popup"),"finish-popup-for-user-width")),Ir&&(y("finish-popup"),y("finish-mask")))),S(o=>{C(o.document.getElementById("treeball"),"tree-cursor"),C(o.document.getElementById("seed"),"tree-cursor"),C(o.document.getElementById("tree"),"tree-cursor")}),(async()=>{let o=await i.default.tabs.query({});o.length>0&&o.forEach(f=>{f.url!==void 0&&(I&&!z(f)||!I&&Y(f))&&i.default.tabs.sendMessage(f.id,yr()).catch(()=>{})})})(),i.default.runtime.sendMessage(Te(I?"white":"black")).catch(()=>{});break;case E.FAILED:t="./images/trees/tree"+(b[w].id+1)+"/"+b[w].prefix+"_dead.png",y("timer-container"),y("seed"),P("tree"),y("plant-board"),y("plant-board-text"),r=i.default.i18n.getMessage("main_top_description_failed"),S(function(o){C(o.document.getElementById("treeball"),"tree-cursor"),C(o.document.getElementById("seed"),"tree-cursor"),C(o.document.getElementById("tree"),"tree-cursor")}),i.default.runtime.sendMessage(Te(I?"white":"black")).catch(()=>{});break}oe=t,S(a=>a.document.getElementById("tree").style.backgroundImage=`url('${t}')`),S(a=>{a.document.getElementById("top-description").textContent=r,C(a.document.getElementById("top-description"),"highlight-top-description")}),currentState===E.READY?(ce("setting-container"),re("edit-container"),re("back-container"),ce("blacklist-container")):(re("blacklist-container"),re("setting-container"),re("edit-container"),(currentState===E.GROWN||currentState===E.FAILED)&&ce("back-container"),currentState===E.GROWING&&(ce("edit-container"),(async()=>{let a=await i.default.tabs.query({});a.length>0&&a.forEach(c=>{c.url!==void 0&&(I&&!z(c)||!I&&Y(c))&&i.default.tabs.sendMessage(c.id,ie({timerText:te(),treeUrl:t})).catch(()=>{})})})())),Cs(),i.default.runtime.sendMessage(xr(currentState)).catch(()=>{})}window.updateUI=W;function Ds(t){N=-1,currentState=E.FAILED,le("grown",()=>{}),i.default.tabs.onUpdated.removeListener(Re),i.default.tabs.onUpdated.removeListener(Ce),i.default.tabs.onReplaced.removeListener(it),t!==null&&window.setTimeout(async()=>{let e=await i.default.tabs.query({url:t.url});var r=t.title;e!==null&&e.length>0&&(r=e[0].title);var s=`${r} ${i.default.i18n.getMessage("notification_text_on_fail")}`;i.default.notifications.create({type:"basic",iconUrl:"icons/notification.png",title:i.default.i18n.getMessage("notification_title_on_fail"),message:s})},1e3),clearTimeout(Je),W()}function Re(t,e,r){!I&&Y(r)&&i.default.tabs.sendMessage(r.id,ie({timerText:te(),treeUrl:oe})).catch(()=>{})}function Ce(t,e,r){I&&!z(r)&&i.default.tabs.sendMessage(r.id,ie({timerText:te(),treeUrl:oe})).catch(()=>{})}function it(t,e){(async()=>{let r=await i.default.tabs.get(t);r!==null&&(Re(r.id,null,r),Ce(r.id,null,r))})()}function kr(){var t=new Date;N=(Ve.getTime()-t.getTime())/1e3,ve=t,t.getTime()-ve.getTime()<6e4&&t.getTime()-ve.getTime()>-6e4||(Rr=!0,i.default.storage.local.get({user:null})),N=Math.floor(N),N>0?((async()=>{var r=(await i.default.storage.local.get({planting:null})).planting;r.plant.end_time=new Date().toISOString();for(var s=0;s<et(st())&&s<r.plant.trees.length;++s)r.plant.trees[s].is_dead=!1,r.plant.trees[s].phase=s+4;i.default.storage.local.set({planting:r})})(),Je=window.setTimeout(kr,1e3)):currentState==E.GROWING&&((async()=>{let e=await i.default.tabs.query({});if(e.length>0)for(var r in e){var s=e[r];(I&&!z(s)||!I&&Y(s))&&i.default.tabs.sendMessage(s.id,"unblock").catch(()=>{})}})(),i.default.tabs.onUpdated.removeListener(Re),i.default.tabs.onUpdated.removeListener(Ce),i.default.tabs.onReplaced.removeListener(it),(async()=>{var r=(await i.default.storage.local.get({planting:null})).planting;r.plant.is_success=!0,r.syncState="WaitForSync";for(var s=0;s<et(st())&&s<r.plant.trees.length;++s)r.plant.trees[s].is_dead=!1,r.plant.trees[s].phase=s+4;r.plant.end_time=new Date().toISOString();var n=new Date(r.plant.start_time);n.setSeconds(n.getSeconds()+D),r.plant.end_time=n.toISOString(),await i.default.storage.local.set({planting:r}),le("grown",()=>{})})(),currentState=E.GROWN,i.default.notifications.create({type:"basic",iconUrl:"icons/notification.png",title:i.default.i18n.getMessage("notification_title_on_success"),message:i.default.i18n.getMessage("notification_text_on_success")}),Dr("NOTIFICATION"),(async()=>{var r=(await i.default.storage.local.get({user:null})).user;r!==null?Xe=!0:Xe=!1,Qe=!1,W(),S(s=>C(s.document.getElementById("finish-popup"),"finish-popup-shrink"))})()),W()}function Pr(t){currentState==E.READY&&(!nt(w)||((async()=>{let e=await i.default.storage.local.get({blackList:getDefaultBlacklist(),planting:null});be=e.blackList;var r=e.planting;if(Rr=!1,ve=new Date,Ve=new Date(new Date().getTime()+N*1e3+200),t)if(r!==null&&typeof r.plant!="undefined"){var s=r.plant;Ve=new Date(Date.parse(s.start_time)+N*1e3+200)}else return;currentState=E.GROWING,t||Rs(),W(),i.default.tabs.onUpdated.addListener(Re),i.default.tabs.onUpdated.addListener(Ce),i.default.tabs.onReplaced.addListener(it),Je=window.setTimeout(kr,1e3),(async()=>{let n=await i.default.tabs.query({});if(n.length>0)for(var a in n){var c=n[a];(I&&!z(c)||!I&&Y(c))&&i.default.tabs.sendMessage(c.id,ie({timerText:te(),treeUrl:oe})).catch(()=>{})}})()})(),i.default.storage.local.get({user:null})))}window.startTimer=Pr;function Ps(t){if(currentState==E.READY){for(;;){if(t<0)w+=1,w>=b.length-1&&(w=0);else if(t>0)w-=1,w<0&&(w=b.length-2);else break;if(!(Sr.includes(b[w].id)&&!nt(w))){i.default.storage.local.set({lastTreeType:w});break}}i.default.storage.local.set({currentTreeIndex:w}),Se(),W()}}window.adjustCurrentTree=Ps;function Bs(t){currentState==E.READY&&(async()=>{t<0?(D+=300,D>7200&&(D=7200)):t>0&&(D-=300,D<600&&(D=600)),i.default.storage.local.set({lastTreeTime:D}),Se(),W()})()}window.adjustPlantTime=Bs;function Br(t){(async()=>{let e=await i.default.storage.local.get({user:null,purchasedProducts:[]}),{user:r}=e;if(r!==null)ee=e.purchasedProducts;else{ee=[],i.default.storage.local.set({purchasedProducts:[]}),W();return}try{let{data:s}=await cr();ee=s,i.default.storage.local.set({purchasedProducts:ee})}catch(s){ee=[],i.default.storage.local.set({purchasedProducts:[]})}t&&t(),W()})()}window.updatePurchasedProducts=Br;function Y(t){return typeof t.url=="undefined"?!1:!!be.find(e=>t.url.includes(e))}window.isBlacklisted=Y;function z(t){return typeof t.url=="undefined"||t.url.startsWith("chrome://newtab")?!0:!!ae.find(e=>t.url.includes(e))}window.isWhitelisted=z;window.setWhitelistMode=t=>I=t;window.getIsWhitelistMode=()=>I;window.setBlacklist=t=>be=t;window.setWhitelist=t=>ae=t;var Dr=t=>{switch(t){case"NOTIFICATION":i.default.browserAction.setIcon({path:{128:"icons/128-notification.png"}});break;case"NORMAL":i.default.browserAction.setIcon({path:{128:"icons/128.png"}});break;default:i.default.browserAction.setIcon({path:{128:"icons/128.png"}});break}};function Ms(t){var e=currentState===E.GROWN?i.default.i18n.getMessage("main_share_on_success"):i.default.i18n.getMessage("main_share_on_failed"),r=currentState===E.GROWN?"http://www.forestapp.cc/sharings/planting_success":"http://www.forestapp.cc/sharings/planting_failed";t==="backBtn"?(Dr("NORMAL"),Se(),W()):t==="twitterBtn"?i.default.tabs.create({url:"https://twitter.com/intent/tweet?text="+e+"&url="+r}):t==="fbBtn"&&i.default.tabs.create({url:"https://www.facebook.com/sharer/sharer.php?u="+r})}window.clickShareButton=Ms;var Os=async()=>{i.default.storage.local.set({DefaultTAG:br}),i.default.runtime.onInstalled.addListener(async()=>{let c=await i.default.storage.local.get({IDtemp:1,grownTree:null});var l=c.grownTree,o=parseInt(c.IDtemp);if(l!=null){for(var f in l)(typeof l[f].browserTreeID=="undefined"||l[f].browserTreeID==null)&&(l[f].syncState="Fail",l[f].browserTreeID=o,o++);await i.default.storage.local.set({grownTree:l,IDtemp:o}),le("sync",()=>{})}});let{user:t}=await i.default.storage.local.get({user:null});!t&&pr();let e=await i.default.tabs.query({});if(e.length>0)for(var r in e){var s=e[r];if(!(typeof s.url=="undefined"||s.url.startsWith("chrome://")||s.url.startsWith("vivaldi://")))try{i.default.tabs.executeScript(s.id,{file:"/content.js"})}catch(c){}}i.default.runtime.onMessage.addListener(c=>(c.giveUp===!0?(Ds(null),i.default.notifications.create({type:"basic",iconUrl:"icons/notification.png",title:i.default.i18n.getMessage("notification_title_on_giveup"),message:i.default.i18n.getMessage("notification_text_on_giveup")}),(async()=>{let l=await i.default.tabs.query({});l.length>0&&l.forEach(o=>{(!I&&Y(o)||I&&!z(o))&&i.default.tabs.sendMessage(o.id,wr(te(),oe)).catch(()=>{})})})()):c.type===Ee&&i.default.runtime.sendMessage(Er()).catch(()=>{}),Promise.resolve("done"))),Br();let n=await i.default.storage.local.get({lastTreeTime:1500,lastTreeTagId:0,currentTreeIndex:0,blackList:getDefaultBlacklist(),whiteList:getDefaultWhitelist(),whitelist:null,isWhitelistMode:!1,doNotShowFinishMessageForGuest:!1});if(D=n.lastTreeTime,ze=n.lastTreeTagId,w=n.currentTreeIndex,Se(),W(),be=n.blackList,ae=n.whiteList,n.whitelist!=null){var a=n.whitelist;i.default.storage.remove("whitelist"),ae.concat(a),i.default.storage.local.set({whiteList:ae})}I=n.isWhitelistMode,Ir=n.doNotShowFinishMessageForGuest,Pr(!0)};Os();})();
